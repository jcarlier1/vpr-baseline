Set reproducible training with seed: 42
Training config: {'epochs': 15, 'learning_rate': 0.0001, 'batch_size': 32, 'pos_threshold_m': 25.0, 'neg_threshold_m': 100.0, 'triplet_margin': 0.5, 'contrastive_temperature': 0.07, 'projection_dim': 256, 'dropout': 0.1, 'weight_decay': 0.0001, 'triplet_weight': 0.3, 'contrastive_weight': 1.0, 'hard_neg_ratio': 0.5}
Loading data with camera_id=front_left_center
Train: 21009 images, Val: 5092 images
Frozen backbone parameters: 86,580,480
Trainable projection parameters: 394,368
Trainable ratio: 0.5%
Created 111 GPS clusters from 21009 images
Starting training...
Epoch  0, Batch   0: Total=8.2163, Cont=8.1459, Trip=0.2346
Epoch  0, Batch  20: Total=6.9308, Cont=6.9308, Trip=0.0000
Epoch  0, Batch  40: Total=3.8607, Cont=3.8607, Trip=0.0000
Epoch  0, Batch  60: Total=3.5717, Cont=3.5001, Trip=0.2387
Epoch  0, Batch  80: Total=2.1396, Cont=2.1396, Trip=0.0000
Epoch  0, Batch 100: Total=2.4280, Cont=2.4280, Trip=0.0000
Epoch  0, Batch 120: Total=1.6122, Cont=1.5611, Trip=0.1703
Epoch  0, Batch 140: Total=2.3814, Cont=2.3814, Trip=0.0000
Epoch  0, Batch 160: Total=1.9822, Cont=1.9822, Trip=0.0000
Epoch  0, Batch 180: Total=2.6945, Cont=2.6172, Trip=0.2579
Epoch  0, Batch 200: Total=2.6932, Cont=2.6932, Trip=0.0000
Epoch  0, Batch 220: Total=6.1010, Cont=6.1010, Trip=0.0000
Epoch  0, Batch 240: Total=2.4960, Cont=2.4462, Trip=0.1660
Epoch  0, Batch 260: Total=1.7479, Cont=1.7479, Trip=0.0000
Epoch  0, Batch 280: Total=1.7742, Cont=1.7742, Trip=0.0000
Epoch  0, Batch 300: Total=1.5227, Cont=1.5227, Trip=0.0000
Epoch  0, Batch 320: Total=1.3217, Cont=1.3217, Trip=0.0000
Epoch  0, Batch 340: Total=1.3005, Cont=1.3005, Trip=0.0000
Epoch  0, Batch 360: Total=1.4314, Cont=1.4081, Trip=0.0777
Epoch  0, Batch 380: Total=1.3621, Cont=1.3621, Trip=0.0000
Epoch  0, Batch 400: Total=0.9683, Cont=0.9683, Trip=0.0000
Epoch  0, Batch 420: Total=1.7594, Cont=1.7358, Trip=0.0788
Epoch  0, Batch 440: Total=3.1347, Cont=3.1347, Trip=0.0000
Epoch  0, Batch 460: Total=1.0954, Cont=1.0954, Trip=0.0000
Epoch  0, Batch 480: Total=1.5294, Cont=1.5089, Trip=0.0685
Epoch  0, Batch 500: Total=1.8147, Cont=1.8147, Trip=0.0000
Epoch  0, Batch 520: Total=1.1002, Cont=1.1002, Trip=0.0000
Epoch  0, Batch 540: Total=2.2455, Cont=2.1980, Trip=0.1581
Epoch  0, Batch 560: Total=1.6933, Cont=1.6933, Trip=0.0000
Epoch  0, Batch 580: Total=1.3644, Cont=1.3644, Trip=0.0000
Epoch  0, Batch 600: Total=1.8457, Cont=1.7779, Trip=0.2262
Epoch  0, Batch 620: Total=1.6981, Cont=1.6981, Trip=0.0000
Epoch  0, Batch 640: Total=1.4283, Cont=1.4283, Trip=0.0000
Epoch  0 Summary: Total=2.3094, Cont=2.2947, Trip=0.0492
Created 88 GPS clusters from 5092 images
Validation R@1: 1.0000
Saved best model with R@1: 1.0000
Epoch  1, Batch   0: Total=1.3977, Cont=1.3962, Trip=0.0049
Epoch  1, Batch  20: Total=1.7194, Cont=1.7194, Trip=0.0000
Epoch  1, Batch  40: Total=1.3514, Cont=1.3514, Trip=0.0000
Epoch  1, Batch  60: Total=1.3799, Cont=1.3799, Trip=0.0000
Epoch  1, Batch  80: Total=1.5866, Cont=1.5866, Trip=0.0000
Epoch  1, Batch 100: Total=1.5569, Cont=1.5569, Trip=0.0000
Epoch  1, Batch 120: Total=2.0493, Cont=1.9872, Trip=0.2071
Epoch  1, Batch 140: Total=1.2843, Cont=1.2843, Trip=0.0000
Epoch  1, Batch 160: Total=1.5749, Cont=1.5749, Trip=0.0000
Epoch  1, Batch 180: Total=1.6678, Cont=1.6343, Trip=0.1116
Epoch  1, Batch 200: Total=1.0494, Cont=1.0494, Trip=0.0000
Epoch  1, Batch 220: Total=1.6249, Cont=1.6249, Trip=0.0000
Epoch  1, Batch 240: Total=1.1614, Cont=1.1614, Trip=0.0000
Epoch  1, Batch 260: Total=1.4328, Cont=1.4328, Trip=0.0000
Epoch  1, Batch 280: Total=1.4277, Cont=1.4277, Trip=0.0000
Epoch  1, Batch 300: Total=1.5661, Cont=1.5165, Trip=0.1656
Epoch  1, Batch 320: Total=2.4794, Cont=2.4794, Trip=0.0000
Epoch  1, Batch 340: Total=1.7683, Cont=1.7683, Trip=0.0000
Epoch  1, Batch 360: Total=1.2587, Cont=1.2227, Trip=0.1201
Epoch  1, Batch 380: Total=1.2479, Cont=1.2479, Trip=0.0000
Epoch  1, Batch 400: Total=1.4907, Cont=1.4907, Trip=0.0000
Epoch  1, Batch 420: Total=1.3924, Cont=1.3858, Trip=0.0218
Epoch  1, Batch 440: Total=1.7504, Cont=1.7504, Trip=0.0000
Epoch  1, Batch 460: Total=0.9429, Cont=0.9429, Trip=0.0000
Epoch  1, Batch 480: Total=1.5050, Cont=1.4949, Trip=0.0336
Epoch  1, Batch 500: Total=1.9287, Cont=1.9287, Trip=0.0000
Epoch  1, Batch 520: Total=1.4249, Cont=1.4249, Trip=0.0000
Epoch  1, Batch 540: Total=1.5040, Cont=1.4478, Trip=0.1873
Epoch  1, Batch 560: Total=1.3498, Cont=1.3498, Trip=0.0000
Epoch  1, Batch 580: Total=1.3975, Cont=1.3975, Trip=0.0000
Epoch  1, Batch 600: Total=1.0105, Cont=1.0084, Trip=0.0071
Epoch  1, Batch 620: Total=1.5095, Cont=1.5095, Trip=0.0000
Epoch  1, Batch 640: Total=1.5198, Cont=1.5198, Trip=0.0000
Epoch  1 Summary: Total=1.4598, Cont=1.4493, Trip=0.0351
Epoch  2, Batch   0: Total=1.6839, Cont=1.6581, Trip=0.0859
Epoch  2, Batch  20: Total=1.3435, Cont=1.3435, Trip=0.0000
Epoch  2, Batch  40: Total=1.8635, Cont=1.8635, Trip=0.0000
Epoch  2, Batch  60: Total=1.1746, Cont=1.1505, Trip=0.0804
Epoch  2, Batch  80: Total=1.1706, Cont=1.1706, Trip=0.0000
Epoch  2, Batch 100: Total=0.9903, Cont=0.9903, Trip=0.0000
Epoch  2, Batch 120: Total=0.3596, Cont=0.3596, Trip=0.0000
Epoch  2, Batch 140: Total=1.4376, Cont=1.4376, Trip=0.0000
Epoch  2, Batch 160: Total=1.2277, Cont=1.2277, Trip=0.0000
Epoch  2, Batch 180: Total=1.1407, Cont=1.1233, Trip=0.0579
Epoch  2, Batch 200: Total=1.5773, Cont=1.5773, Trip=0.0000
Epoch  2, Batch 220: Total=1.5541, Cont=1.5541, Trip=0.0000
Epoch  2, Batch 240: Total=1.8021, Cont=1.7590, Trip=0.1436
Epoch  2, Batch 260: Total=1.8571, Cont=1.8571, Trip=0.0000
Epoch  2, Batch 280: Total=1.2567, Cont=1.2567, Trip=0.0000
Epoch  2, Batch 300: Total=1.2263, Cont=1.2036, Trip=0.0757
Epoch  2, Batch 320: Total=1.6224, Cont=1.6224, Trip=0.0000
Epoch  2, Batch 340: Total=1.4164, Cont=1.4164, Trip=0.0000
Epoch  2, Batch 360: Total=1.3256, Cont=1.2937, Trip=0.1061
Epoch  2, Batch 380: Total=1.1381, Cont=1.1381, Trip=0.0000
Epoch  2, Batch 400: Total=0.9308, Cont=0.9308, Trip=0.0000
Epoch  2, Batch 420: Total=1.2009, Cont=1.2009, Trip=0.0000
Epoch  2, Batch 440: Total=1.4494, Cont=1.4494, Trip=0.0000
Epoch  2, Batch 460: Total=1.2474, Cont=1.2474, Trip=0.0000
Epoch  2, Batch 480: Total=1.4122, Cont=1.3853, Trip=0.0898
Epoch  2, Batch 500: Total=0.9180, Cont=0.9180, Trip=0.0000
Epoch  2, Batch 520: Total=1.3914, Cont=1.3914, Trip=0.0000
Epoch  2, Batch 540: Total=1.5447, Cont=1.5039, Trip=0.1359
Epoch  2, Batch 560: Total=1.5391, Cont=1.5391, Trip=0.0000
Epoch  2, Batch 580: Total=1.2777, Cont=1.2777, Trip=0.0000
Epoch  2, Batch 600: Total=0.9448, Cont=0.9448, Trip=0.0000
Epoch  2, Batch 620: Total=1.4776, Cont=1.4776, Trip=0.0000
Epoch  2, Batch 640: Total=1.0079, Cont=1.0079, Trip=0.0000
Epoch  2 Summary: Total=1.2951, Cont=1.2870, Trip=0.0271
Epoch  3, Batch   0: Total=1.2824, Cont=1.2641, Trip=0.0611
Epoch  3, Batch  20: Total=1.5253, Cont=1.5253, Trip=0.0000
Epoch  3, Batch  40: Total=1.3270, Cont=1.3270, Trip=0.0000
Epoch  3, Batch  60: Total=1.5356, Cont=1.5215, Trip=0.0468
Epoch  3, Batch  80: Total=1.1707, Cont=1.1707, Trip=0.0000
Epoch  3, Batch 100: Total=1.2862, Cont=1.2862, Trip=0.0000
Epoch  3, Batch 120: Total=0.9736, Cont=0.9736, Trip=0.0000
Epoch  3, Batch 140: Total=1.2654, Cont=1.2654, Trip=0.0000
Epoch  3, Batch 160: Total=1.1644, Cont=1.1644, Trip=0.0000
Epoch  3, Batch 180: Total=1.0881, Cont=1.0877, Trip=0.0011
Epoch  3, Batch 200: Total=0.7322, Cont=0.7322, Trip=0.0000
Epoch  3, Batch 220: Total=1.5226, Cont=1.5226, Trip=0.0000
Epoch  3, Batch 240: Total=1.2057, Cont=1.1976, Trip=0.0268
Epoch  3, Batch 260: Total=1.4467, Cont=1.4467, Trip=0.0000
Epoch  3, Batch 280: Total=1.3229, Cont=1.3229, Trip=0.0000
Epoch  3, Batch 300: Total=0.9891, Cont=0.9683, Trip=0.0691
Epoch  3, Batch 320: Total=1.0493, Cont=1.0493, Trip=0.0000
Epoch  3, Batch 340: Total=1.4541, Cont=1.4541, Trip=0.0000
Epoch  3, Batch 360: Total=1.4289, Cont=1.4021, Trip=0.0893
Epoch  3, Batch 380: Total=1.2359, Cont=1.2359, Trip=0.0000
Epoch  3, Batch 400: Total=1.2561, Cont=1.2561, Trip=0.0000
Epoch  3, Batch 420: Total=1.1663, Cont=1.1663, Trip=0.0000
Epoch  3, Batch 440: Total=0.7346, Cont=0.7346, Trip=0.0000
Epoch  3, Batch 460: Total=1.5535, Cont=1.5535, Trip=0.0000
Epoch  3, Batch 480: Total=2.4884, Cont=2.4860, Trip=0.0078
Epoch  3, Batch 500: Total=1.4763, Cont=1.4763, Trip=0.0000
Epoch  3, Batch 520: Total=0.9424, Cont=0.9424, Trip=0.0000
Epoch  3, Batch 540: Total=1.6582, Cont=1.5750, Trip=0.2775
Epoch  3, Batch 560: Total=1.4529, Cont=1.4529, Trip=0.0000
Epoch  3, Batch 580: Total=1.4086, Cont=1.4086, Trip=0.0000
Epoch  3, Batch 600: Total=1.5218, Cont=1.4917, Trip=0.1004
Epoch  3, Batch 620: Total=1.2154, Cont=1.2154, Trip=0.0000
Epoch  3, Batch 640: Total=1.1969, Cont=1.1969, Trip=0.0000
Epoch  3 Summary: Total=1.2498, Cont=1.2438, Trip=0.0201
Created 88 GPS clusters from 5092 images
Validation R@1: 1.0000
Epoch  4, Batch   0: Total=1.7665, Cont=1.7665, Trip=0.0000
Epoch  4, Batch  20: Total=1.2323, Cont=1.2323, Trip=0.0000
Epoch  4, Batch  40: Total=1.1437, Cont=1.1437, Trip=0.0000
Epoch  4, Batch  60: Total=1.2650, Cont=1.2285, Trip=0.1217
Epoch  4, Batch  80: Total=0.9157, Cont=0.9157, Trip=0.0000
Epoch  4, Batch 100: Total=1.0841, Cont=1.0841, Trip=0.0000
Epoch  4, Batch 120: Total=1.3062, Cont=1.2966, Trip=0.0319
Epoch  4, Batch 140: Total=1.0473, Cont=1.0473, Trip=0.0000
Epoch  4, Batch 160: Total=1.3418, Cont=1.3418, Trip=0.0000
Epoch  4, Batch 180: Total=1.7087, Cont=1.6786, Trip=0.1003
Epoch  4, Batch 200: Total=1.0924, Cont=1.0924, Trip=0.0000
Epoch  4, Batch 220: Total=1.2374, Cont=1.2374, Trip=0.0000
Epoch  4, Batch 240: Total=1.1367, Cont=1.1367, Trip=0.0000
Epoch  4, Batch 260: Total=1.2124, Cont=1.2124, Trip=0.0000
Epoch  4, Batch 280: Total=1.3244, Cont=1.3244, Trip=0.0000
Epoch  4, Batch 300: Total=1.4359, Cont=1.4158, Trip=0.0670
Epoch  4, Batch 320: Total=1.2012, Cont=1.2012, Trip=0.0000
Epoch  4, Batch 340: Total=1.1177, Cont=1.1177, Trip=0.0000
Epoch  4, Batch 360: Total=1.2535, Cont=1.2261, Trip=0.0915
Epoch  4, Batch 380: Total=1.4519, Cont=1.4519, Trip=0.0000
Epoch  4, Batch 400: Total=0.9864, Cont=0.9864, Trip=0.0000
Epoch  4, Batch 420: Total=1.2378, Cont=1.2050, Trip=0.1092
Epoch  4, Batch 440: Total=1.2090, Cont=1.2090, Trip=0.0000
Epoch  4, Batch 460: Total=1.2888, Cont=1.2888, Trip=0.0000
Epoch  4, Batch 480: Total=1.0593, Cont=1.0066, Trip=0.1755
Epoch  4, Batch 500: Total=1.0861, Cont=1.0861, Trip=0.0000
Epoch  4, Batch 520: Total=0.9327, Cont=0.9327, Trip=0.0000
Epoch  4, Batch 540: Total=0.9507, Cont=0.9464, Trip=0.0143
Epoch  4, Batch 560: Total=1.3300, Cont=1.3300, Trip=0.0000
Epoch  4, Batch 580: Total=1.3203, Cont=1.3203, Trip=0.0000
Epoch  4, Batch 600: Total=1.1435, Cont=1.1435, Trip=0.0000
Epoch  4, Batch 620: Total=1.3379, Cont=1.3379, Trip=0.0000
Epoch  4, Batch 640: Total=1.2859, Cont=1.2859, Trip=0.0000
Epoch  4 Summary: Total=1.1973, Cont=1.1918, Trip=0.0183
Epoch  5, Batch   0: Total=1.1572, Cont=1.0927, Trip=0.2152
Epoch  5, Batch  20: Total=0.7849, Cont=0.7849, Trip=0.0000
Epoch  5, Batch  40: Total=1.0903, Cont=1.0903, Trip=0.0000
Epoch  5, Batch  60: Total=1.3530, Cont=1.3143, Trip=0.1289
Epoch  5, Batch  80: Total=0.8628, Cont=0.8628, Trip=0.0000
Epoch  5, Batch 100: Total=0.5616, Cont=0.5616, Trip=0.0000
Epoch  5, Batch 120: Total=1.0820, Cont=1.0820, Trip=0.0000
Epoch  5, Batch 140: Total=1.0753, Cont=1.0753, Trip=0.0000
Epoch  5, Batch 160: Total=1.3326, Cont=1.3326, Trip=0.0000
Epoch  5, Batch 180: Total=1.1338, Cont=1.1265, Trip=0.0243
Epoch  5, Batch 200: Total=1.7320, Cont=1.7320, Trip=0.0000
Epoch  5, Batch 220: Total=1.3587, Cont=1.3587, Trip=0.0000
Epoch  5, Batch 240: Total=1.1111, Cont=1.1064, Trip=0.0159
Epoch  5, Batch 260: Total=0.6881, Cont=0.6881, Trip=0.0000
Epoch  5, Batch 280: Total=1.5173, Cont=1.5173, Trip=0.0000
Epoch  5, Batch 300: Total=0.9229, Cont=0.9229, Trip=0.0000
Epoch  5, Batch 320: Total=1.2189, Cont=1.2189, Trip=0.0000
Epoch  5, Batch 340: Total=1.1321, Cont=1.1321, Trip=0.0000
Epoch  5, Batch 360: Total=1.0865, Cont=1.0839, Trip=0.0088
Epoch  5, Batch 380: Total=0.9219, Cont=0.9219, Trip=0.0000
Epoch  5, Batch 400: Total=0.9262, Cont=0.9262, Trip=0.0000
Epoch  5, Batch 420: Total=1.3614, Cont=1.3260, Trip=0.1181
Epoch  5, Batch 440: Total=1.2088, Cont=1.2088, Trip=0.0000
Epoch  5, Batch 460: Total=1.0115, Cont=1.0115, Trip=0.0000
Epoch  5, Batch 480: Total=0.4524, Cont=0.4456, Trip=0.0225
Epoch  5, Batch 500: Total=1.1087, Cont=1.1087, Trip=0.0000
Epoch  5, Batch 520: Total=1.2938, Cont=1.2938, Trip=0.0000
Epoch  5, Batch 540: Total=1.6118, Cont=1.6118, Trip=0.0000
Epoch  5, Batch 560: Total=0.9006, Cont=0.9006, Trip=0.0000
Epoch  5, Batch 580: Total=1.2815, Cont=1.2815, Trip=0.0000
Epoch  5, Batch 600: Total=1.2047, Cont=1.2001, Trip=0.0153
Epoch  5, Batch 620: Total=0.8668, Cont=0.8668, Trip=0.0000
Epoch  5, Batch 640: Total=1.1648, Cont=1.1648, Trip=0.0000
Epoch  5 Summary: Total=1.1587, Cont=1.1539, Trip=0.0162
Epoch  6, Batch   0: Total=1.7258, Cont=1.7258, Trip=0.0000
Epoch  6, Batch  20: Total=1.0462, Cont=1.0462, Trip=0.0000
Epoch  6, Batch  40: Total=1.2110, Cont=1.2110, Trip=0.0000
Epoch  6, Batch  60: Total=1.0384, Cont=1.0306, Trip=0.0259
Epoch  6, Batch  80: Total=1.3673, Cont=1.3673, Trip=0.0000
Epoch  6, Batch 100: Total=0.8567, Cont=0.8567, Trip=0.0000
Epoch  6, Batch 120: Total=1.3127, Cont=1.3075, Trip=0.0173
Epoch  6, Batch 140: Total=1.1610, Cont=1.1610, Trip=0.0000
Epoch  6, Batch 160: Total=1.1493, Cont=1.1493, Trip=0.0000
Epoch  6, Batch 180: Total=1.2602, Cont=1.2445, Trip=0.0524
Epoch  6, Batch 200: Total=1.0339, Cont=1.0339, Trip=0.0000
Epoch  6, Batch 220: Total=1.2443, Cont=1.2443, Trip=0.0000
Epoch  6, Batch 240: Total=0.8517, Cont=0.8517, Trip=0.0000
Epoch  6, Batch 260: Total=1.2583, Cont=1.2583, Trip=0.0000
Epoch  6, Batch 280: Total=1.2328, Cont=1.2328, Trip=0.0000
Epoch  6, Batch 300: Total=1.2996, Cont=1.2996, Trip=0.0000
Epoch  6, Batch 320: Total=0.8365, Cont=0.8365, Trip=0.0000
Epoch  6, Batch 340: Total=0.8534, Cont=0.8534, Trip=0.0000
Epoch  6, Batch 360: Total=1.5466, Cont=1.4852, Trip=0.2048
Epoch  6, Batch 380: Total=0.9487, Cont=0.9487, Trip=0.0000
Epoch  6, Batch 400: Total=1.0726, Cont=1.0726, Trip=0.0000
Epoch  6, Batch 420: Total=1.3361, Cont=1.3361, Trip=0.0000
Epoch  6, Batch 440: Total=1.3084, Cont=1.3084, Trip=0.0000
Epoch  6, Batch 460: Total=0.7877, Cont=0.7877, Trip=0.0000
Epoch  6, Batch 480: Total=1.3626, Cont=1.3575, Trip=0.0168
Epoch  6, Batch 500: Total=1.0281, Cont=1.0281, Trip=0.0000
Epoch  6, Batch 520: Total=0.7619, Cont=0.7619, Trip=0.0000
Epoch  6, Batch 540: Total=1.3641, Cont=1.3625, Trip=0.0052
Epoch  6, Batch 560: Total=1.2836, Cont=1.2836, Trip=0.0000
Epoch  6, Batch 580: Total=1.2647, Cont=1.2647, Trip=0.0000
Epoch  6, Batch 600: Total=1.1348, Cont=1.1098, Trip=0.0834
Epoch  6, Batch 620: Total=1.0186, Cont=1.0186, Trip=0.0000
Epoch  6, Batch 640: Total=1.1733, Cont=1.1733, Trip=0.0000
Epoch  6 Summary: Total=1.1187, Cont=1.1157, Trip=0.0101
Created 88 GPS clusters from 5092 images
Validation R@1: 1.0000
Epoch  7, Batch   0: Total=1.2881, Cont=1.2766, Trip=0.0383
Epoch  7, Batch  20: Total=0.8222, Cont=0.8222, Trip=0.0000
Epoch  7, Batch  40: Total=1.1473, Cont=1.1473, Trip=0.0000
Epoch  7, Batch  60: Total=0.7088, Cont=0.7059, Trip=0.0096
Epoch  7, Batch  80: Total=1.0623, Cont=1.0623, Trip=0.0000
Epoch  7, Batch 100: Total=0.7950, Cont=0.7950, Trip=0.0000
Epoch  7, Batch 120: Total=1.5747, Cont=1.5747, Trip=0.0000
Epoch  7, Batch 140: Total=1.1786, Cont=1.1786, Trip=0.0000
Epoch  7, Batch 160: Total=0.9598, Cont=0.9598, Trip=0.0000
Epoch  7, Batch 180: Total=1.3084, Cont=1.2810, Trip=0.0913
Epoch  7, Batch 200: Total=0.9036, Cont=0.9036, Trip=0.0000
Epoch  7, Batch 220: Total=0.9913, Cont=0.9913, Trip=0.0000
Epoch  7, Batch 240: Total=1.6361, Cont=1.6361, Trip=0.0000
Epoch  7, Batch 260: Total=0.9242, Cont=0.9242, Trip=0.0000
Epoch  7, Batch 280: Total=1.0433, Cont=1.0433, Trip=0.0000
Epoch  7, Batch 300: Total=1.2287, Cont=1.2287, Trip=0.0000
Epoch  7, Batch 320: Total=0.9071, Cont=0.9071, Trip=0.0000
Epoch  7, Batch 340: Total=1.0171, Cont=1.0171, Trip=0.0000
Epoch  7, Batch 360: Total=1.3480, Cont=1.3184, Trip=0.0988
Epoch  7, Batch 380: Total=1.0920, Cont=1.0920, Trip=0.0000
Epoch  7, Batch 400: Total=1.2666, Cont=1.2666, Trip=0.0000
Epoch  7, Batch 420: Total=1.0056, Cont=0.9982, Trip=0.0249
Epoch  7, Batch 440: Total=0.9757, Cont=0.9757, Trip=0.0000
Epoch  7, Batch 460: Total=0.8249, Cont=0.8249, Trip=0.0000
Epoch  7, Batch 480: Total=0.8545, Cont=0.8543, Trip=0.0005
Epoch  7, Batch 500: Total=1.2380, Cont=1.2380, Trip=0.0000
Epoch  7, Batch 520: Total=1.1627, Cont=1.1627, Trip=0.0000
Epoch  7, Batch 540: Total=1.0571, Cont=1.0571, Trip=0.0000
Epoch  7, Batch 560: Total=1.1110, Cont=1.1110, Trip=0.0000
Epoch  7, Batch 580: Total=0.6166, Cont=0.6166, Trip=0.0000
Epoch  7, Batch 600: Total=1.1157, Cont=1.1157, Trip=0.0000
Epoch  7, Batch 620: Total=0.8783, Cont=0.8783, Trip=0.0000
Epoch  7, Batch 640: Total=0.9786, Cont=0.9786, Trip=0.0000
Epoch  7 Summary: Total=1.0819, Cont=1.0798, Trip=0.0072
Epoch  8, Batch   0: Total=0.8644, Cont=0.8644, Trip=0.0000
Epoch  8, Batch  20: Total=1.1116, Cont=1.1116, Trip=0.0000
Epoch  8, Batch  40: Total=1.0839, Cont=1.0839, Trip=0.0000
Epoch  8, Batch  60: Total=0.7515, Cont=0.7515, Trip=0.0000
Epoch  8, Batch  80: Total=1.3873, Cont=1.3873, Trip=0.0000
Epoch  8, Batch 100: Total=1.2653, Cont=1.2653, Trip=0.0000
Epoch  8, Batch 120: Total=1.3938, Cont=1.3938, Trip=0.0000
Epoch  8, Batch 140: Total=0.7914, Cont=0.7914, Trip=0.0000
Epoch  8, Batch 160: Total=1.1017, Cont=1.1017, Trip=0.0000
Epoch  8, Batch 180: Total=0.8695, Cont=0.8667, Trip=0.0093
Epoch  8, Batch 200: Total=0.5075, Cont=0.5075, Trip=0.0000
Epoch  8, Batch 220: Total=1.4320, Cont=1.4320, Trip=0.0000
Epoch  8, Batch 240: Total=1.2668, Cont=1.2587, Trip=0.0270
Epoch  8, Batch 260: Total=0.9794, Cont=0.9794, Trip=0.0000
Epoch  8, Batch 280: Total=0.9788, Cont=0.9788, Trip=0.0000
Epoch  8, Batch 300: Total=0.9069, Cont=0.9020, Trip=0.0161
Epoch  8, Batch 320: Total=0.9224, Cont=0.9224, Trip=0.0000
Epoch  8, Batch 340: Total=1.1617, Cont=1.1617, Trip=0.0000
Epoch  8, Batch 360: Total=1.1560, Cont=1.1560, Trip=0.0000
Epoch  8, Batch 380: Total=1.0704, Cont=1.0704, Trip=0.0000
Epoch  8, Batch 400: Total=1.0130, Cont=1.0130, Trip=0.0000
Epoch  8, Batch 420: Total=1.0807, Cont=1.0643, Trip=0.0547
Epoch  8, Batch 440: Total=0.9820, Cont=0.9820, Trip=0.0000
Epoch  8, Batch 460: Total=1.0506, Cont=1.0506, Trip=0.0000
Epoch  8, Batch 480: Total=0.9853, Cont=0.9843, Trip=0.0031
Epoch  8, Batch 500: Total=1.2319, Cont=1.2319, Trip=0.0000
Epoch  8, Batch 520: Total=0.9460, Cont=0.9460, Trip=0.0000
Epoch  8, Batch 540: Total=0.9264, Cont=0.9225, Trip=0.0131
Epoch  8, Batch 560: Total=0.9397, Cont=0.9397, Trip=0.0000
Epoch  8, Batch 580: Total=0.8272, Cont=0.8272, Trip=0.0000
Epoch  8, Batch 600: Total=0.8879, Cont=0.8879, Trip=0.0000
Epoch  8, Batch 620: Total=1.0526, Cont=1.0526, Trip=0.0000
Epoch  8, Batch 640: Total=0.9512, Cont=0.9512, Trip=0.0000
Epoch  8 Summary: Total=1.0724, Cont=1.0699, Trip=0.0082
Epoch  9, Batch   0: Total=0.7206, Cont=0.6882, Trip=0.1079
Epoch  9, Batch  20: Total=1.0127, Cont=1.0127, Trip=0.0000
Epoch  9, Batch  40: Total=0.8603, Cont=0.8603, Trip=0.0000
Epoch  9, Batch  60: Total=1.1043, Cont=1.0347, Trip=0.2322
Epoch  9, Batch  80: Total=1.0131, Cont=1.0131, Trip=0.0000
Epoch  9, Batch 100: Total=1.0590, Cont=1.0590, Trip=0.0000
Epoch  9, Batch 120: Total=1.6232, Cont=1.6232, Trip=0.0000
Epoch  9, Batch 140: Total=1.1523, Cont=1.1523, Trip=0.0000
Epoch  9, Batch 160: Total=0.9754, Cont=0.9754, Trip=0.0000
Epoch  9, Batch 180: Total=1.4951, Cont=1.4938, Trip=0.0041
Epoch  9, Batch 200: Total=0.6433, Cont=0.6433, Trip=0.0000
Epoch  9, Batch 220: Total=1.2324, Cont=1.2324, Trip=0.0000
Epoch  9, Batch 240: Total=0.9491, Cont=0.9424, Trip=0.0225
Epoch  9, Batch 260: Total=1.2543, Cont=1.2543, Trip=0.0000
Epoch  9, Batch 280: Total=1.3645, Cont=1.3645, Trip=0.0000
Epoch  9, Batch 300: Total=0.8696, Cont=0.8696, Trip=0.0000
Epoch  9, Batch 320: Total=0.8248, Cont=0.8248, Trip=0.0000
Epoch  9, Batch 340: Total=1.0789, Cont=1.0789, Trip=0.0000
Epoch  9, Batch 360: Total=0.9058, Cont=0.8981, Trip=0.0255
Epoch  9, Batch 380: Total=1.2404, Cont=1.2404, Trip=0.0000
Epoch  9, Batch 400: Total=1.4218, Cont=1.4218, Trip=0.0000
Epoch  9, Batch 420: Total=1.0721, Cont=1.0721, Trip=0.0000
Epoch  9, Batch 440: Total=1.0322, Cont=1.0322, Trip=0.0000
Epoch  9, Batch 460: Total=1.2464, Cont=1.2464, Trip=0.0000
Epoch  9, Batch 480: Total=0.6969, Cont=0.6969, Trip=0.0000
Epoch  9, Batch 500: Total=1.2313, Cont=1.2313, Trip=0.0000
Epoch  9, Batch 520: Total=1.1169, Cont=1.1169, Trip=0.0000
Epoch  9, Batch 540: Total=1.0092, Cont=0.9827, Trip=0.0882
Epoch  9, Batch 560: Total=0.8792, Cont=0.8792, Trip=0.0000
Epoch  9, Batch 580: Total=0.8800, Cont=0.8800, Trip=0.0000
Epoch  9, Batch 600: Total=1.4817, Cont=1.4797, Trip=0.0068
Epoch  9, Batch 620: Total=1.2819, Cont=1.2819, Trip=0.0000
Epoch  9, Batch 640: Total=1.2142, Cont=1.2142, Trip=0.0000
Epoch  9 Summary: Total=1.0657, Cont=1.0640, Trip=0.0059
Created 88 GPS clusters from 5092 images
Validation R@1: 1.0000
Epoch 10, Batch   0: Total=0.8594, Cont=0.8433, Trip=0.0536
Epoch 10, Batch  20: Total=0.8544, Cont=0.8544, Trip=0.0000
Epoch 10, Batch  40: Total=0.8620, Cont=0.8620, Trip=0.0000
Epoch 10, Batch  60: Total=1.2557, Cont=1.2557, Trip=0.0000
Epoch 10, Batch  80: Total=1.3944, Cont=1.3944, Trip=0.0000
Epoch 10, Batch 100: Total=1.0588, Cont=1.0588, Trip=0.0000
Epoch 10, Batch 120: Total=1.1831, Cont=1.1831, Trip=0.0000
Epoch 10, Batch 140: Total=1.3658, Cont=1.3658, Trip=0.0000
Epoch 10, Batch 160: Total=1.2608, Cont=1.2608, Trip=0.0000
Epoch 10, Batch 180: Total=1.1395, Cont=1.1378, Trip=0.0058
Epoch 10, Batch 200: Total=0.8967, Cont=0.8967, Trip=0.0000
Epoch 10, Batch 220: Total=0.9140, Cont=0.9140, Trip=0.0000
Epoch 10, Batch 240: Total=0.9379, Cont=0.9379, Trip=0.0000
Epoch 10, Batch 260: Total=0.9062, Cont=0.9062, Trip=0.0000
Epoch 10, Batch 280: Total=1.0748, Cont=1.0748, Trip=0.0000
Epoch 10, Batch 300: Total=0.9143, Cont=0.9143, Trip=0.0000
Epoch 10, Batch 320: Total=1.4480, Cont=1.4480, Trip=0.0000
Epoch 10, Batch 340: Total=0.8847, Cont=0.8847, Trip=0.0000
Epoch 10, Batch 360: Total=0.7298, Cont=0.7217, Trip=0.0271
Epoch 10, Batch 380: Total=1.1882, Cont=1.1882, Trip=0.0000
Epoch 10, Batch 400: Total=0.9791, Cont=0.9791, Trip=0.0000
Epoch 10, Batch 420: Total=1.4566, Cont=1.4566, Trip=0.0000
Epoch 10, Batch 440: Total=0.7465, Cont=0.7465, Trip=0.0000
Epoch 10, Batch 460: Total=1.1362, Cont=1.1362, Trip=0.0000
Epoch 10, Batch 480: Total=0.9184, Cont=0.9149, Trip=0.0118
Epoch 10, Batch 500: Total=1.3157, Cont=1.3157, Trip=0.0000
Epoch 10, Batch 520: Total=1.0028, Cont=1.0028, Trip=0.0000
Epoch 10, Batch 540: Total=1.0572, Cont=1.0455, Trip=0.0390
Epoch 10, Batch 560: Total=1.0558, Cont=1.0558, Trip=0.0000
Epoch 10, Batch 580: Total=0.9652, Cont=0.9652, Trip=0.0000
Epoch 10, Batch 600: Total=1.1474, Cont=1.1474, Trip=0.0000
Epoch 10, Batch 620: Total=1.2576, Cont=1.2576, Trip=0.0000
Epoch 10, Batch 640: Total=1.1299, Cont=1.1299, Trip=0.0000
Epoch 10 Summary: Total=1.0398, Cont=1.0379, Trip=0.0064
Epoch 11, Batch   0: Total=0.7477, Cont=0.7477, Trip=0.0000
Epoch 11, Batch  20: Total=0.8776, Cont=0.8776, Trip=0.0000
Epoch 11, Batch  40: Total=1.0834, Cont=1.0834, Trip=0.0000
Epoch 11, Batch  60: Total=1.6218, Cont=1.6218, Trip=0.0000
Epoch 11, Batch  80: Total=0.9579, Cont=0.9579, Trip=0.0000
Epoch 11, Batch 100: Total=1.0307, Cont=1.0307, Trip=0.0000
Epoch 11, Batch 120: Total=0.8733, Cont=0.8671, Trip=0.0207
Epoch 11, Batch 140: Total=0.9123, Cont=0.9123, Trip=0.0000
Epoch 11, Batch 160: Total=1.1580, Cont=1.1580, Trip=0.0000
Epoch 11, Batch 180: Total=1.2994, Cont=1.2994, Trip=0.0000
Epoch 11, Batch 200: Total=0.9398, Cont=0.9398, Trip=0.0000
Epoch 11, Batch 220: Total=0.7271, Cont=0.7271, Trip=0.0000
Epoch 11, Batch 240: Total=0.9523, Cont=0.9523, Trip=0.0000
Epoch 11, Batch 260: Total=0.8584, Cont=0.8584, Trip=0.0000
Epoch 11, Batch 280: Total=1.1959, Cont=1.1959, Trip=0.0000
Epoch 11, Batch 300: Total=0.9307, Cont=0.9307, Trip=0.0000
Epoch 11, Batch 320: Total=1.2884, Cont=1.2884, Trip=0.0000
Epoch 11, Batch 340: Total=0.7602, Cont=0.7602, Trip=0.0000
Epoch 11, Batch 360: Total=0.9235, Cont=0.9235, Trip=0.0000
Epoch 11, Batch 380: Total=1.4240, Cont=1.4240, Trip=0.0000
Epoch 11, Batch 400: Total=1.0331, Cont=1.0331, Trip=0.0000
Epoch 11, Batch 420: Total=1.0210, Cont=1.0210, Trip=0.0000
Epoch 11, Batch 440: Total=0.8098, Cont=0.8098, Trip=0.0000
Epoch 11, Batch 460: Total=0.9799, Cont=0.9799, Trip=0.0000
Epoch 11, Batch 480: Total=1.0024, Cont=1.0024, Trip=0.0000
Epoch 11, Batch 500: Total=0.9813, Cont=0.9813, Trip=0.0000
Epoch 11, Batch 520: Total=0.8427, Cont=0.8427, Trip=0.0000
Epoch 11, Batch 540: Total=0.7655, Cont=0.7613, Trip=0.0138
Epoch 11, Batch 560: Total=0.6399, Cont=0.6399, Trip=0.0000
Epoch 11, Batch 580: Total=0.8151, Cont=0.8151, Trip=0.0000
Epoch 11, Batch 600: Total=1.1009, Cont=1.1009, Trip=0.0000
Epoch 11, Batch 620: Total=1.1980, Cont=1.1980, Trip=0.0000
Epoch 11, Batch 640: Total=0.9012, Cont=0.9012, Trip=0.0000
Epoch 11 Summary: Total=1.0343, Cont=1.0327, Trip=0.0051
Epoch 12, Batch   0: Total=0.8953, Cont=0.8953, Trip=0.0000
Epoch 12, Batch  20: Total=0.9410, Cont=0.9410, Trip=0.0000
Epoch 12, Batch  40: Total=1.0315, Cont=1.0315, Trip=0.0000
Epoch 12, Batch  60: Total=0.7870, Cont=0.7863, Trip=0.0022
Epoch 12, Batch  80: Total=0.8503, Cont=0.8503, Trip=0.0000
Epoch 12, Batch 100: Total=1.1569, Cont=1.1569, Trip=0.0000
Epoch 12, Batch 120: Total=1.0481, Cont=1.0468, Trip=0.0045
Epoch 12, Batch 140: Total=0.9439, Cont=0.9439, Trip=0.0000
Epoch 12, Batch 160: Total=0.8892, Cont=0.8892, Trip=0.0000
Epoch 12, Batch 180: Total=0.8697, Cont=0.8697, Trip=0.0000
Epoch 12, Batch 200: Total=1.1084, Cont=1.1084, Trip=0.0000
Epoch 12, Batch 220: Total=0.8719, Cont=0.8719, Trip=0.0000
Epoch 12, Batch 240: Total=0.9507, Cont=0.9507, Trip=0.0000
Epoch 12, Batch 260: Total=1.3495, Cont=1.3495, Trip=0.0000
Epoch 12, Batch 280: Total=0.9758, Cont=0.9758, Trip=0.0000
Epoch 12, Batch 300: Total=1.0794, Cont=1.0773, Trip=0.0069
Epoch 12, Batch 320: Total=1.2092, Cont=1.2092, Trip=0.0000
Epoch 12, Batch 340: Total=1.1471, Cont=1.1471, Trip=0.0000
Epoch 12, Batch 360: Total=1.0824, Cont=1.0640, Trip=0.0616
Epoch 12, Batch 380: Total=1.1230, Cont=1.1230, Trip=0.0000
Epoch 12, Batch 400: Total=1.0106, Cont=1.0106, Trip=0.0000
Epoch 12, Batch 420: Total=0.7841, Cont=0.7841, Trip=0.0000
Epoch 12, Batch 440: Total=0.9967, Cont=0.9967, Trip=0.0000
Epoch 12, Batch 460: Total=1.3145, Cont=1.3145, Trip=0.0000
Epoch 12, Batch 480: Total=1.0821, Cont=1.0821, Trip=0.0000
Epoch 12, Batch 500: Total=0.7528, Cont=0.7528, Trip=0.0000
Epoch 12, Batch 520: Total=0.9753, Cont=0.9753, Trip=0.0000
Epoch 12, Batch 540: Total=0.7499, Cont=0.7499, Trip=0.0000
Epoch 12, Batch 560: Total=0.8248, Cont=0.8248, Trip=0.0000
Epoch 12, Batch 580: Total=1.0290, Cont=1.0290, Trip=0.0000
Epoch 12, Batch 600: Total=0.6756, Cont=0.6739, Trip=0.0057
Epoch 12, Batch 620: Total=0.8615, Cont=0.8615, Trip=0.0000
Epoch 12, Batch 640: Total=1.1811, Cont=1.1811, Trip=0.0000
Epoch 12 Summary: Total=1.0318, Cont=1.0307, Trip=0.0038
Created 88 GPS clusters from 5092 images
Validation R@1: 1.0000
Epoch 13, Batch   0: Total=1.0254, Cont=1.0254, Trip=0.0000
Epoch 13, Batch  20: Total=0.7400, Cont=0.7400, Trip=0.0000
Epoch 13, Batch  40: Total=0.8434, Cont=0.8434, Trip=0.0000
Epoch 13, Batch  60: Total=1.1567, Cont=1.1567, Trip=0.0000
Epoch 13, Batch  80: Total=1.2159, Cont=1.2159, Trip=0.0000
Epoch 13, Batch 100: Total=1.1236, Cont=1.1236, Trip=0.0000
Epoch 13, Batch 120: Total=0.9154, Cont=0.9154, Trip=0.0000
Epoch 13, Batch 140: Total=1.0978, Cont=1.0978, Trip=0.0000
Epoch 13, Batch 160: Total=0.7874, Cont=0.7874, Trip=0.0000
Epoch 13, Batch 180: Total=1.1435, Cont=1.1435, Trip=0.0000
Epoch 13, Batch 200: Total=1.0615, Cont=1.0615, Trip=0.0000
Epoch 13, Batch 220: Total=1.1859, Cont=1.1859, Trip=0.0000
Epoch 13, Batch 240: Total=0.7450, Cont=0.7450, Trip=0.0000
Epoch 13, Batch 260: Total=1.1570, Cont=1.1570, Trip=0.0000
Epoch 13, Batch 280: Total=1.0024, Cont=1.0024, Trip=0.0000
Epoch 13, Batch 300: Total=1.2852, Cont=1.2764, Trip=0.0293
Epoch 13, Batch 320: Total=1.0148, Cont=1.0148, Trip=0.0000
Epoch 13, Batch 340: Total=1.0003, Cont=1.0003, Trip=0.0000
Epoch 13, Batch 360: Total=1.3013, Cont=1.2868, Trip=0.0484
Epoch 13, Batch 380: Total=1.0648, Cont=1.0648, Trip=0.0000
Epoch 13, Batch 400: Total=1.2133, Cont=1.2133, Trip=0.0000
Epoch 13, Batch 420: Total=0.9200, Cont=0.9129, Trip=0.0237
Epoch 13, Batch 440: Total=0.8369, Cont=0.8369, Trip=0.0000
Epoch 13, Batch 460: Total=1.0624, Cont=1.0624, Trip=0.0000
Epoch 13, Batch 480: Total=1.1558, Cont=1.1558, Trip=0.0000
Epoch 13, Batch 500: Total=0.7469, Cont=0.7469, Trip=0.0000
Epoch 13, Batch 520: Total=0.6315, Cont=0.6315, Trip=0.0000
Epoch 13, Batch 540: Total=0.9146, Cont=0.9146, Trip=0.0000
Epoch 13, Batch 560: Total=0.6540, Cont=0.6540, Trip=0.0000
Epoch 13, Batch 580: Total=0.9910, Cont=0.9910, Trip=0.0000
Epoch 13, Batch 600: Total=1.4031, Cont=1.3536, Trip=0.1650
Epoch 13, Batch 620: Total=0.9448, Cont=0.9448, Trip=0.0000
Epoch 13, Batch 640: Total=0.8376, Cont=0.8376, Trip=0.0000
Epoch 13 Summary: Total=1.0210, Cont=1.0199, Trip=0.0036
Epoch 14, Batch   0: Total=1.2800, Cont=1.2793, Trip=0.0022
Epoch 14, Batch  20: Total=1.0455, Cont=1.0455, Trip=0.0000
Epoch 14, Batch  40: Total=0.8598, Cont=0.8598, Trip=0.0000
Epoch 14, Batch  60: Total=0.9602, Cont=0.9602, Trip=0.0000
Epoch 14, Batch  80: Total=1.9383, Cont=1.9383, Trip=0.0000
Epoch 14, Batch 100: Total=0.9261, Cont=0.9261, Trip=0.0000
Epoch 14, Batch 120: Total=0.8392, Cont=0.8392, Trip=0.0000
Epoch 14, Batch 140: Total=0.9599, Cont=0.9599, Trip=0.0000
Epoch 14, Batch 160: Total=1.1758, Cont=1.1758, Trip=0.0000
Epoch 14, Batch 180: Total=0.9091, Cont=0.9091, Trip=0.0000
Epoch 14, Batch 200: Total=1.0374, Cont=1.0374, Trip=0.0000
Epoch 14, Batch 220: Total=1.2302, Cont=1.2302, Trip=0.0000
Epoch 14, Batch 240: Total=0.8359, Cont=0.8359, Trip=0.0000
Epoch 14, Batch 260: Total=0.9836, Cont=0.9836, Trip=0.0000
Epoch 14, Batch 280: Total=0.9777, Cont=0.9777, Trip=0.0000
Epoch 14, Batch 300: Total=1.1143, Cont=1.0769, Trip=0.1248
Epoch 14, Batch 320: Total=0.7838, Cont=0.7838, Trip=0.0000
Epoch 14, Batch 340: Total=0.7289, Cont=0.7289, Trip=0.0000
Epoch 14, Batch 360: Total=0.9726, Cont=0.9726, Trip=0.0000
Epoch 14, Batch 380: Total=0.9576, Cont=0.9576, Trip=0.0000
Epoch 14, Batch 400: Total=1.4438, Cont=1.4438, Trip=0.0000
Epoch 14, Batch 420: Total=0.7570, Cont=0.7570, Trip=0.0000
Epoch 14, Batch 440: Total=1.2139, Cont=1.2139, Trip=0.0000
Epoch 14, Batch 460: Total=1.1522, Cont=1.1522, Trip=0.0000
Epoch 14, Batch 480: Total=0.8204, Cont=0.8147, Trip=0.0187
Epoch 14, Batch 500: Total=0.6894, Cont=0.6894, Trip=0.0000
Epoch 14, Batch 520: Total=0.7929, Cont=0.7929, Trip=0.0000
Epoch 14, Batch 540: Total=0.9482, Cont=0.9482, Trip=0.0000
Epoch 14, Batch 560: Total=0.8452, Cont=0.8452, Trip=0.0000
Epoch 14, Batch 580: Total=1.0250, Cont=1.0250, Trip=0.0000
Epoch 14, Batch 600: Total=1.1334, Cont=1.1334, Trip=0.0000
Epoch 14, Batch 620: Total=1.0209, Cont=1.0209, Trip=0.0000
Epoch 14, Batch 640: Total=1.1587, Cont=1.1587, Trip=0.0000
Epoch 14 Summary: Total=1.0456, Cont=1.0440, Trip=0.0054
Created 88 GPS clusters from 5092 images
Validation R@1: 1.0000
Training completed. Best validation R@1: 1.0000

Training completed!
Model: dinov2_b
Best validation R@1: 1.0000
Model saved to: trained_dinov2_b_seed42.pth